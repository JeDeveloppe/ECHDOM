<!-- Début du formulaire de bien -->
{{ form_start(propertyForm, {'attr': {'id': 'propertyForm'}}) }}

    <h5 class="fw-bold text-dark mb-4">Informations principales</h5>
    <div class="row g-3 mb-5">
        <div class="col-md-6">
            {{ form_row(propertyForm.type) }}
        </div>
        <div class="col-md-6">
            {{ form_row(propertyForm.surface) }}
        </div>
        <div class="col-md-4">
            {{ form_row(propertyForm.rooms) }}
        </div>
        <div class="col-md-4">
            {{ form_row(propertyForm.bedrooms) }}
        </div>
        <div class="col-md-4">
            {{ form_row(propertyForm.bathrooms) }}
        </div>
        <div class="col-12 d-flex flex-wrap align-items-center">
            <div class="col-md-4">
                {{ form_row(propertyForm.floor) }}
            </div>
            <div class="col-md-4 text-center">
                {{ form_row(propertyForm.hasElevator) }}
            </div>
            <div class="col-md-4 text-center">
                {{ form_row(propertyForm.hasBalcony) }}
            </div>
        </div>
        <div class="col-md-6">
            {{ form_row(propertyForm.typeOfGarage) }}
        </div>
        <div class="col-md-6">
            {{ form_row(propertyForm.typeOfParking) }}
        </div>
    </div>

    <hr class="my-4">

    <h5 class="fw-bold text-dark mb-4">Adresse</h5>
    <div class="row g-3 mb-5">
        {% if home is defined %}
            <div class="col-12">
                Lieu actuel: {{ home.address ? home.address : '' | raw }}
            </div>
        {% endif %}
        <div class="col-12">
        <div class="col-12">
            <div class="position-relative w-100">
                {# Le champ d'adresse avec l'attribut id personnalisé pour le JavaScript #}
                {{ form_row(propertyForm.address, {'label': false, 'attr': {'id': 'home_address', 'class': 'form-control rounded-pill', 'placeholder': 'Entrez une adresse complète', 'autocomplete': 'off'}}) }}
                <!-- Conteneur pour les résultats de l'autocomplétion -->
                <div id="autocomplete-results" class="position-absolute w-100 bg-white border border-top-0 rounded-bottom-3 shadow-sm z-3 overflow-y-auto" style="max-height: 200px; display: none; z-index: 100;"></div>
            </div>
            {# Champs cachés pour la latitude et la longitude #}
            {{ form_row(propertyForm.latitude, {'attr': {'id': 'home_latitude'}}) }}
            {{ form_row(propertyForm.longitude, {'attr': {'id': 'home_longitude'}}) }}
            {# Jeton CSRF caché #}
            {{ form_row(propertyForm._token, {'attr': {'id': 'home_token'}}) }}
        </div>

        {# NOUVEAU : Ajout du conteneur pour les messages #}
        <div id="property-message" class="mb-4"></div>
    </div>

    <hr class="my-4">

    <h5 class="fw-bold text-dark mb-4">Équipements</h5>
    <div class="row mb-5">
        <div class="col-12">
            <div class="card bg-light border-0 p-3">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-2">
                    {% for equipment in propertyForm.equipments %}
                        <div class="col">
                            {{ form_row(equipment, {
                                'label_attr': {
                                    'class': 'form-check-label me-2'
                                }
                            }) }}
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <hr class="my-4">

    <h5 class="fw-bold text-dark mb-4">Description et règles</h5>
    <div class="row g-3 mb-5">
        <div class="col-12">
            {{ form_row(propertyForm.description) }}
        </div>
        <div class="12">
            {{ form_row(propertyForm.otherRules) }}
        </div>
    </div>

    <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
        <button type="submit" class="btn btn-primary btn-lg rounded-pill shadow px-5"
                data-original-text="{% if isEditMode %}Mettre à jour mon bien{% else %}Ajouter mon bien{% endif %}">
            <span id="buttonText">
                {% if isEditMode %}
                    <i id="saveIcon" class="fas fa-pen-to-square me-2"></i> Mettre à jour mon bien
                {% else %}
                    <i id="saveIcon" class="fas fa-plus-circle me-2"></i> Ajouter mon bien
                {% endif %}
            </span>
            <span id="loadingIcon" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
        </button>
    </div>
{{ form_end(propertyForm) }}
